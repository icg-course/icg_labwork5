<DOCTYPE html>
  <html lang="en">

  <head>
    <meta charset="UTF-8">
    <title>Лабораторная работа 5</title>
    <link rel="stylesheet" href="style.css">
    <script src="script.js"></script>
    <script src='https://www.x3dom.org/download/dev/x3dom-full.js'> </script>
    <link rel='stylesheet' type='text/css' href='https://www.x3dom.org/download/x3dom.css'>
    </link>
    <script type='text/javascript'>

      function stop() { //Позволяет отобразить или скрыть 
        let stp = Time_or.getAttribute("enabled");
        if (stp == "false") {
          Time_or.setAttribute("enabled", "true");
          but_mn.value = "Останови луну";
        }
        else {
          Time_or.setAttribute("enabled", "false");
          but_mn.value = "Крути луну";
        }
      }
      function sovet() {
        let sov = mus.getAttribute("enabled");
        if (sov == "false") {
          mus.setAttribute("enabled", "true");
          but_sovs.value = "Только останови.....";
        }
        else {
          mus.setAttribute("enabled", "false");
          but_sovs.value = "ГИМН!!!";
        }
      }

      function addNode() {
        x = 0;
        y = 7;
        z = -7;

        x1 = -0.12
        y1 = 9;
        z1 = 15;
        let t = Star
        t.setAttribute("translation", x + " " + y + " " + z);
        let c = cam
        c.setAttribute("position", x1 + " " + y1 + " " + z1);

        return false;
      };

    </script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.9.1/themes/base/jquery-ui.css" />
    <script src="https://code.jquery.com/jquery-1.8.3.min.js"></script>
    <script src="https://code.jquery.com/ui/1.9.1/jquery-ui.js"></script>

    <p class="case"> &nbsp;
      Луна
      <input id="but_mn" type="button" value="Раскрути луну" onClick='stop();' />
      ГИМН!
      <input id="but_sovs" type="button" value="СЛАВЬСЯ ОТЕЧЕСТВО" onClick='sovet();' />
      Лучший вид для того чтобы нажать кнопку "Гимн"
      <input type="button" value="Вид" onclick="window.addNode();" />
    </p>
  </head>

  <body>
    <h1>Мартынов В.Ю 4842</h1>
    <X3D width="1280px" height="720px">
      <Scene>

        <!-- Коллизия -->
        <Collision DEF="Coll">

          <Transform DEF="All">
            <!-- Ссылка на объект (INLINE) -->
            <Transform DEF="Moon" translation="0 0 0">
              <Inline url="Ball.x3d"></Inline>
            </Transform>

            <!-- Полный флаг -->

            <Transform Translation="0 0 -0.4">
              <!-- Флагшток -->
              <Transform Translation="-1 6.3 0">
                <shape>
                  <appearance>
                    <material diffusecolor="0.5 0.5 0.5"></material>
                  </appearance>
                  <Cylinder radius="0.05" height="3"></Cylinder>
                </shape>
              </Transform>

              <!-- Элемент флага 1 -->
              <Transform Translation="-1 7.8 0" rotation="1 0 0 1.57">
                <shape>
                  <appearance>
                    <material diffusecolor="0.8 0.9 0.8"></material>
                  </appearance>
                  <torus innerRadius='0.02' outerRadius='0.04'></torus>
                </shape>
              </Transform>

              <!-- Элемент флага 2 -->
              <Transform Translation="-1 7 0" rotation="1 0 0 1.57">
                <shape>
                  <appearance>
                    <material diffusecolor="0.8 0.9 0.8"></material>
                  </appearance>
                  <torus innerRadius='0.02' outerRadius='0.04'></torus>
                </shape>
              </Transform>
            </Transform>
            <!-- Стул -->

            <!-- Группирование и тирражирование -->
            <Group DEF="Chair">
              <!-- ножка 1 -->
              <Group DEF="Leg_S">
                <Transform Translation="-0.25 5 0" rotation="1 0 0 1.57">
                  <shape>
                    <appearance>
                      <ImageTexture url="wood.jpg"></ImageTexture>
                      <material Diffusecolor="0 0 0"></material>
                    </appearance>
                    <box size="0.05 0.05 1"></box>
                  </shape>
                </Transform>
              </Group>
              <!-- ножка 2 -->
              <Transform Translation="0.5 0 0">
                <shape USE="Leg_S">
                </shape>
              </Transform>

              <!-- ножка 3 -->
              <Transform Translation="0 0 0.5">
                <shape USE="Leg_S">
                </shape>
              </Transform>

              <!-- ножка 4 -->
              <Transform Translation="0.5 0 0.5">
                <shape USE="Leg_S">
                </shape>
              </Transform>

              <!-- сиденье -->
              <Transform Translation="0 5.5 0.25" rotation="1 0 0 1.57">
                <shape>
                  <appearance>
                    <ImageTexture url="wood.jpg"></ImageTexture>
                    <material Diffusecolor="0 0 0"></material>
                  </appearance>
                  <box size="0.56 0.56 0.1"></box>
                </shape>
              </Transform>

              <!-- Спинка -->
              <Transform Translation="0 5.9 0" rotation="1 0 0 1.57">
                <shape>
                  <appearance>
                    <ImageTexture url="wood.jpg"></ImageTexture>
                    <material Diffusecolor="0 0 0"></material>
                  </appearance>
                  <box size="0.56 0.05 0.7"></box>
                </shape>
              </Transform>
            </Group>

            <!-- Флаг(Advanced) -->
            <Anchor Url="https://www.youtube.com/watch?v=aWt9bGilBa0&t=1s&ab_channel=utsprut2">
              <Transform translation="-1 7 -0.4" rotation="1 0 0 -1.5708">
                <Shape>
                  <appearance>
                    <imagetexture url="sr2.jpg"></imagetexture>
                  </appearance>
                  <ElevationGrid xDimension="5" zDimension="5" height="0, 0.1, 0.02, 0.02, 0.01,
                          0, 0.06, 0.04, 0.03, 0.02,
                          0, 0.01, 0.08, -0.01, -0.014,
                          0, -0.01, 0, 0.07, 0.011,
                          0, 0, 0, 0, 0" xSpacing="0.4" zSpacing="0.2" solid="false">
                  </ElevationGrid>
            </Anchor>

          </Transform>

          <TimeSensor id="Time_or" DEF="Time" cycleInterval="9" loop="true" enabled="false"> </TimeSensor>
          <OrientationInterpolator DEF="OrientInt" key="0 0.5 1" keyValue="0 0 1 0, 0 0 1 -3.14, 0 0 1 -6.28">
          </OrientationInterpolator>
          <OrientationChaser DEF="OC" duration="2"></OrientationChaser>
          <OrientationDamper DEF="OD" tau="1"></OrientationDamper>
          <!-- Руты -->
          <ROUTE fromNode="Time" fromField="fraction_changed" toNode="OrientInt" toField="set_fraction"></ROUTE>
          <ROUTE fromNode="OrientInt" fromField="value_changed" toNode="OC" toField="set_destination"></ROUTE>
          <ROUTE fromNode="OC" fromField="value_changed" toNode="OD" toField="set_destination"></ROUTE>
          <ROUTE fromNode="OD" fromField="value_changed" toNode="All" toField="set_rotation"></ROUTE>

          <!-- Текст -->
          <Transform Translation="-0.9 8 0" scale="0.5 0.5">
            <shape>
              <appearance>
                <material DEF="Mat" diffusecolor="#ff0000"></material>
              </appearance>
              <text string="Присядь">
                <fontstyle family="Helvetica sans-serif"></fontstyle>
              </text>
            </shape>
          </Transform>

          <!-- Сенсор 2 -->
          <TimeSensor DEF="Time2" cycleInterval="1" loop="true"> </TimeSensor>
          <ColorInterpolator DEF="ColInt" key="0 0.5 0.8 1" keyValue="1 0 0, 1 0.5 0, 1 0.5 0.5, 1 0 0">
          </ColorInterpolator>
          <ColorChaser DEF="CC" duration="2"></ColorChaser>
          <!-- Руты -->
          <ROUTE fromNode="Time2" fromField="fraction_changed" toNode="ColInt" toField="set_fraction"></ROUTE>
          <ROUTE fromNode="CC" fromField="value_changed" toNode="Mat" toField="set_fraction"></ROUTE>
          <ROUTE fromNode="ColInt" fromField="value_changed" toNode="Mat" toField="set_diffuseColor"></ROUTE>

          <!-- Спутник -->
          <Transform Translation="-3 7 -5" rotation="0 0 1 1.7">
            <shape>
              <appearance>
                <ImageTexture url="sptn.jpg"></ImageTexture>
                <material Diffusecolor="0 0 0"></material>
              </appearance>
              <cone></cone>
            </shape>
          </Transform>

          <!-- Часть спутника 1 -->
          <Transform Translation="-1 6.25 -5" rotation="0 0 1 1.5">
            <shape>
              <appearance>
                <ImageTexture url="sptnpt.jpg"></ImageTexture>
                <material Diffusecolor="0 0 0"></material>
              </appearance>
              <cylinder radius="0.1" height="2.1"></cylinder>
            </shape>
          </Transform>

          <!-- Часть спутника 2 -->
          <Transform Translation="-1.3 8.25 -5" rotation="0 0 1 1.9">
            <shape>
              <appearance>
                <ImageTexture url="sptnpt.jpg"></ImageTexture>
                <material Diffusecolor="0 0 0"></material>
              </appearance>
              <cylinder radius="0.1" height="2.1"></cylinder>
            </shape>
          </Transform>
        </Collision>


        <!--________________________ЛАБОРАТОРНАЯ РАБОТА 2________________________ -->
        <!-- Пыль(частицы) -->
        <Transform Translation="-2 5 0">
          <Shape>
            <PointSet>
              <Color color="1 1 1, 1 1 1, 1 1 1, 
                                        1 1 1, 1 1 1, 1 1 1, 
                                        1 1 1, 1 1 1, 1 1 1">
              </Color>
              <Coordinate point="1 2 1, 3 2 2, 1 2 0,
                               0 1 3, 4 2 1, 2 0 -1
                               -1 5 1, 3 0 -1, -1 0 1"></Coordinate>
            </PointSet>
          </Shape>
        </Transform>

        <!-- Линии спутника -->
        <Transform Translation="0 6.2 -5">
          <Shape>
            <IndexedLineSet coordIndex="0 1 -1 2 3 -1" colorPerVertex='true'>
              <Coordinate point="0 0 0, 10 1 0, -0.3 2.4 0, 10 3.4 0"></Coordinate>
              <Color color="1 1 1, 1 1 1, 1 1 1, 1 1 1"></Color>
            </IndexedLineSet>
          </Shape>
        </Transform>

        <!-- Звезда -->
        <transform id="Star" Translation="0 15 -14">
          <Shape>
            <appearance>
              <Material Diffusecolor="1 0 0"></Material>
            </appearance>
            <IndexedFaceSet ccw="true" colorPerVertex="true" solid="false" coordIndex="0 1 2 3 4 5 6 7 8 9 0 -1">
              <Coordinate point="0 2 0, -2 1 0, -1.5 3 0, -3 4 0, -1 4 0, 0 7 0, 1 4 0, 3 4 0, 1.5 3 0, 2 1 0">
              </Coordinate>
            </IndexedFaceSet>
          </Shape>
        </transform>

        <!-- Указатель -->
        <Transform DEF="UpDn" translation="-0.5 7.5 0">
          <Shape>
            <IndexedTriangleSet index="0 1 2" solid="false">
              <Coordinate point="0 0 0, 1 0 0, 0.5 -1 0"></Coordinate>
              <ColorRGBA color="0 .4 0 1, 0 1 1 1, 1 0 0 0"></ColorRGBA>
            </IndexedTriangleSet>
          </Shape>
        </Transform>

        <!-- Сенсор 1 -->
        <TimeSensor DEF="Time3" cycleInterval="2" loop="true">
        </TimeSensor>

        <!-- Интерполятор позиции -->
        <PositionInterpolator DEF="PosInt" key="0 0.4 0.8 1" keyValue="-0.5 7.5 0, -0.5 8 0, -0.5 7.2 0, -0.5 7.5 0">
        </PositionInterpolator>

        <!-- Руты -->
        <ROUTE fromNode="Time3" fromField="fraction_changed" toNode="PosInt" toField="set_fraction"></ROUTE>
        <ROUTE fromNode="PosInt" fromField="value_changed" toNode="UpDn" toField="set_translation"></ROUTE>


        <!-- СтрипСет -->
        <Transform translation="1 3.6 -5" rotation="0 0 1 0.27">
          <Shape>
            <IndexedTriangleStripSet index='0 1 2 3 4 5 6 7 -1' solid='false'>
              <Coordinate point='-2 4 0, 2 3 0, 3 5 0, 4 2 0, 7 6 0, 10 1 0, 14 8 0, 16 4 0'></Coordinate>
              <ColorRGBA color='0.57 0.51 0.77 0.2, 0.57 0.51 0.77 0.2, 0.57 0.51 0.77 0.2, 
                                      0.57 0.51 0.77 0.1, 0.57 0.51 0.77 0.1, 0.57 0.51 0.77 0.1, 
                                      0.67 0.59 0.77 0.05, 0.7 0.7 0.77 0.01'></ColorRGBA>
            </IndexedTriangleStripSet>
          </Shape>
        </Transform>


        <!-- Свет -->
        <!-- Освещение звезды -->
        <Group DEF="Light">
          <PointLight ambientIntensity='0' attenuation='1,0,0' color='1,0,0' global='false' intensity='1'
            location='0 15 6' on='true' radius='100' shadowFilterSize='0' shadowIntensity='1' shadowMapSize='1024'
            shadowOffset='0'></PointLight>

          <!-- Солнечный свет -->
          <DirectionalLight ambientIntensity='0' color='1,0.6,0.6' direction='0,0,-1' global='false' intensity='0.8'
            on='true' shadowCascades='1' shadowFilterSize='0' shadowIntensity='0.4' shadowMapSize='2024'
            shadowOffset='0' shadowSplitFactor='1'></DirectionalLight>

          <!-- Подсветка сцены -->
          <SpotLight ambientIntensity='0' attenuation='1,0,0' beamWidth='1.5' color='0.5,0.4,0.4' cutOffAngle='1'
            direction='0,-1,-0.5' global='false' intensity='0.5' location='0,8,9' radius='20' shadowCascades='1'
            shadowFilterSize='2' shadowIntensity='1' shadowMapSize='1024'></SpotLight>

        </Group>

        <!-- Навигация -->
        <NavigationInfo avatarSize='[ 3, 5, 4 ]' explorationMode='all' speed='5.0' transitionTime='1.0'
          transitionType='["LINEAR"]' headlight='false' type="fly"></NavigationInfo>

        <!-- Туман -->
        <Fog bind='true' color='(1,1,1)' fogType='EXPONENTIAL' isActive='true' visibilityRange='45'></Fog>

        <Audioclip id="mus" url="Ussr.mp3" loop="True" enabled="false"></Audioclip>
        <!-- Фон -->
        <Background backUrl='space.jpg'>
        </Background>

        <!-- Камера -->
        <Viewpoint id="cam" position="0 7 6" orientation="0 0 0 0" zNear="0" zFar="100" fieldOfView="0.9">
        </Viewpoint>

      </Scene>
    </X3D>
  </body>

  </html>